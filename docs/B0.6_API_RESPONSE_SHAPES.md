# B0.6 API Response Shapes (Backend-Verified)

Source: `postman/backend-aligned-run.json` generated from the passing backend-aligned Newman suite.

- Run status: `40 requests`, `111 assertions`, `0 failed`
- Base URL: `http://localhost:8080`
- Notes: IDs and timestamps are dynamic; example values below are representative.

## Endpoint Response Reference

### 1. Register Test Student
- Endpoint: `POST /api/auth/register`
- Verified status: `200`
- Response body type: `string`
- Sample: `User registered successfully`

### 2. Login Test Student
- Endpoint: `POST /api/auth/login`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `token`: `string`

### 3. Login Bootstrap Admin
- Endpoint: `POST /api/auth/login`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `token`: `string`

### 4. Create Hierarchy Root A
- Endpoint: `POST /api/admin/hierarchy?slug=suite-root-a-{{run_id}}&nameEn=SuiteRootA&descriptionEn=RootA&sortOrder=0&createdBy=suite-admin`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `children`: `array`
  - `createdAt`: `string`
  - `createdBy`: `string`
  - `deleted`: `boolean`
  - `descriptionEn`: `string`
  - `id`: `number`
  - `nameEn`: `string`
  - `parent`: `null`
  - `published`: `boolean`
  - `slug`: `string`
  - `sortOrder`: `number`
  - `updatedAt`: `string`
  - `version`: `number`
  - `visible`: `boolean`

### 5. Create Hierarchy Root B
- Endpoint: `POST /api/admin/hierarchy?slug=suite-root-b-{{run_id}}&nameEn=SuiteRootB&descriptionEn=RootB&sortOrder=1&createdBy=suite-admin`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `children`: `array`
  - `createdAt`: `string`
  - `createdBy`: `string`
  - `deleted`: `boolean`
  - `descriptionEn`: `string`
  - `id`: `number`
  - `nameEn`: `string`
  - `parent`: `null`
  - `published`: `boolean`
  - `slug`: `string`
  - `sortOrder`: `number`
  - `updatedAt`: `string`
  - `version`: `number`
  - `visible`: `boolean`

### 6. Create Hierarchy Child
- Endpoint: `POST /api/admin/hierarchy?slug=suite-child-{{run_id}}&nameEn=SuiteChild&descriptionEn=ChildNode&parentId={{hierarchy_root_id_a}}&sortOrder=0`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `children`: `array`
  - `createdAt`: `string`
  - `createdBy`: `null`
  - `deleted`: `boolean`
  - `descriptionEn`: `string`
  - `id`: `number`
  - `nameEn`: `string`
  - `parent`: `object`
  - `published`: `boolean`
  - `slug`: `string`
  - `sortOrder`: `number`
  - `updatedAt`: `string`
  - `version`: `number`
  - `visible`: `boolean`

### 7. Update Hierarchy Root A
- Endpoint: `PUT /api/admin/hierarchy/{{hierarchy_root_id_a}}?nameEn=SuiteRootAUpdated&descriptionEn=UpdatedRootA&sortOrder=2&isPublished=true&isVisible=true`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `children`: `array`
  - `createdAt`: `string`
  - `createdBy`: `string`
  - `deleted`: `boolean`
  - `descriptionEn`: `string`
  - `id`: `number`
  - `nameEn`: `string`
  - `parent`: `null`
  - `published`: `boolean`
  - `slug`: `string`
  - `sortOrder`: `number`
  - `updatedAt`: `string`
  - `version`: `number`
  - `visible`: `boolean`

### 8. Move Hierarchy Child to Root B
- Endpoint: `PUT /api/admin/hierarchy/{{hierarchy_child_id}}/move?newParentId={{hierarchy_root_id_b}}`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `children`: `array`
  - `createdAt`: `string`
  - `createdBy`: `null`
  - `deleted`: `boolean`
  - `descriptionEn`: `string`
  - `id`: `number`
  - `nameEn`: `string`
  - `parent`: `object`
  - `published`: `boolean`
  - `slug`: `string`
  - `sortOrder`: `number`
  - `updatedAt`: `string`
  - `version`: `number`
  - `visible`: `boolean`

### 9. Get Hierarchy Roots (Public)
- Endpoint: `GET /api/hierarchy/roots`
- Verified status: `200`
- Response body type: `array`
- Sample length in run: `30`
- Array item shape (top-level):
  - `children`: `array`
  - `createdAt`: `string`
  - `createdBy`: `string`
  - `deleted`: `boolean`
  - `descriptionEn`: `string`
  - `id`: `number`
  - `nameEn`: `string`
  - `parent`: `null`
  - `published`: `boolean`
  - `slug`: `string`
  - `sortOrder`: `number`
  - `updatedAt`: `string`
  - `version`: `number`
  - `visible`: `boolean`

### 10. Get Hierarchy Children (Public)
- Endpoint: `GET /api/hierarchy/{{hierarchy_root_id_b}}/children`
- Verified status: `200`
- Response body type: `array`
- Sample length in run: `1`
- Array item shape (top-level):
  - `children`: `array`
  - `createdAt`: `string`
  - `createdBy`: `null`
  - `deleted`: `boolean`
  - `descriptionEn`: `string`
  - `id`: `number`
  - `nameEn`: `string`
  - `parent`: `object`
  - `published`: `boolean`
  - `slug`: `string`
  - `sortOrder`: `number`
  - `updatedAt`: `string`
  - `version`: `number`
  - `visible`: `boolean`

### 11. Soft Delete Hierarchy Child
- Endpoint: `DELETE /api/admin/hierarchy/{{hierarchy_child_id}}`
- Verified status: `204`
- Response body: empty

### 12. Restore Hierarchy Child
- Endpoint: `PUT /api/admin/hierarchy/{{hierarchy_child_id}}/restore`
- Verified status: `204`
- Response body: empty

### 13. Create Course
- Endpoint: `POST /api/admin/courses?hierarchyNodeId={{hierarchy_root_id_a}}&titleEn=SuiteCourse{{run_id}}&descriptionEn=SuiteCourseDesc&difficulty=BEGINNER&languageCode=en&estimatedDurationMinutes=120&createdByRole=ADMIN`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `archived`: `boolean`
  - `createdAt`: `string`
  - `createdByRole`: `string`
  - `deleted`: `boolean`
  - `descriptionEn`: `string`
  - `difficulty`: `string`
  - `estimatedDurationMinutes`: `number`
  - `hierarchyNode`: `object`
  - `id`: `number`
  - `languageCode`: `string`
  - `sortOrder`: `number`
  - `status`: `string`
  - `titleEn`: `string`
  - `updatedAt`: `string`
  - `version`: `number`

### 14. Publish Course
- Endpoint: `POST /api/admin/courses/{{course_id}}/publish`
- Verified status: `200`
- Response body: empty

### 15. Create Lesson TEXT
- Endpoint: `POST /api/admin/lessons/course/{{course_id}}?type=TEXT&orderIndex=0&textContent=WelcomeToTheCourse`
- Verified status: `201`
- Response body type: `object`
- Object shape (top-level):
  - `childLessons`: `array`
  - `course`: `object`
  - `createdAt`: `string`
  - `deleted`: `boolean`
  - `depthLevel`: `number`
  - `documentUrl`: `null`
  - `id`: `number`
  - `orderIndex`: `number`
  - `parentLesson`: `null`
  - `path`: `string`
  - `textContent`: `string`
  - `type`: `string`
  - `updatedAt`: `string`
  - `videoUrl`: `null`

### 16. Create Lesson VIDEO
- Endpoint: `POST /api/admin/lessons/course/{{course_id}}?type=VIDEO&orderIndex=1&videoUrl=https://example.com/video.mp4`
- Verified status: `201`
- Response body type: `object`
- Object shape (top-level):
  - `childLessons`: `array`
  - `course`: `object`
  - `createdAt`: `string`
  - `deleted`: `boolean`
  - `depthLevel`: `number`
  - `documentUrl`: `null`
  - `id`: `number`
  - `orderIndex`: `number`
  - `parentLesson`: `null`
  - `path`: `string`
  - `textContent`: `null`
  - `type`: `string`
  - `updatedAt`: `string`
  - `videoUrl`: `string`

### 17. Create Lesson DOCUMENT
- Endpoint: `POST /api/admin/lessons/course/{{course_id}}?type=DOCUMENT&orderIndex=2&documentUrl=https://example.com/document.pdf`
- Verified status: `201`
- Response body type: `object`
- Object shape (top-level):
  - `childLessons`: `array`
  - `course`: `object`
  - `createdAt`: `string`
  - `deleted`: `boolean`
  - `depthLevel`: `number`
  - `documentUrl`: `string`
  - `id`: `number`
  - `orderIndex`: `number`
  - `parentLesson`: `null`
  - `path`: `string`
  - `textContent`: `null`
  - `type`: `string`
  - `updatedAt`: `string`
  - `videoUrl`: `null`

### 18. Get Lessons for Course (Admin Query)
- Endpoint: `GET /api/admin/lesson-queries/course/{{course_id}}`
- Verified status: `200`
- Response body type: `array`
- Sample length in run: `3`
- Array item shape (top-level):
  - `childLessons`: `array`
  - `course`: `object`
  - `createdAt`: `string`
  - `deleted`: `boolean`
  - `depthLevel`: `number`
  - `documentUrl`: `null`
  - `id`: `number`
  - `orderIndex`: `number`
  - `parentLesson`: `null`
  - `path`: `string`
  - `textContent`: `string`
  - `type`: `string`
  - `updatedAt`: `string`
  - `videoUrl`: `null`

### 19. Get Lessons for Course (Public)
- Endpoint: `GET /api/public/lessons/course/{{course_id}}`
- Verified status: `200`
- Response body type: `array`
- Sample length in run: `3`
- Array item shape (top-level):
  - `childLessons`: `array`
  - `course`: `object`
  - `createdAt`: `string`
  - `deleted`: `boolean`
  - `depthLevel`: `number`
  - `documentUrl`: `null`
  - `id`: `number`
  - `orderIndex`: `number`
  - `parentLesson`: `null`
  - `path`: `string`
  - `textContent`: `string`
  - `type`: `string`
  - `updatedAt`: `string`
  - `videoUrl`: `null`

### 20. Get Lesson Tree (Public)
- Endpoint: `GET /api/public/lesson-tree/course/{{course_id}}`
- Verified status: `200`
- Response body type: `array`
- Sample length in run: `3`
- Array item shape (top-level):
  - `id`: `number`
  - `orderIndex`: `number`
  - `depthLevel`: `number`
  - `children`: `array`

### 21. Create Exam
- Endpoint: `POST /api/admin/exams`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `courseId`: `number`
  - `createdAt`: `string`
  - `description`: `string`
  - `id`: `string`
  - `instructions`: `string`
  - `maxAttempts`: `number`
  - `passPercentage`: `number`
  - `rulesSummary`: `string`
  - `shuffleOptions`: `boolean`
  - `shuffleQuestions`: `boolean`
  - `status`: `string`
  - `timeLimitMinutes`: `number`
  - `title`: `string`
  - `updatedAt`: `string`

### 22. Get Exam Details (Instructor Endpoint)
- Endpoint: `GET /api/instructor/exams/{{exam_id}}`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `courseId`: `number`
  - `createdAt`: `string`
  - `description`: `string`
  - `id`: `string`
  - `instructions`: `string`
  - `maxAttempts`: `number`
  - `passPercentage`: `number`
  - `rulesSummary`: `string`
  - `shuffleOptions`: `boolean`
  - `shuffleQuestions`: `boolean`
  - `status`: `string`
  - `timeLimitMinutes`: `number`
  - `title`: `string`
  - `updatedAt`: `string`

### 23. Publish Exam
- Endpoint: `POST /api/admin/exams/{{exam_id}}/publish`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `courseId`: `number`
  - `createdAt`: `string`
  - `description`: `string`
  - `id`: `string`
  - `instructions`: `string`
  - `maxAttempts`: `number`
  - `passPercentage`: `number`
  - `rulesSummary`: `string`
  - `shuffleOptions`: `boolean`
  - `shuffleQuestions`: `boolean`
  - `status`: `string`
  - `timeLimitMinutes`: `number`
  - `title`: `string`
  - `updatedAt`: `string`

### 24. Start Exam Attempt
- Endpoint: `POST /api/student/exams/{{exam_id}}/start?userId={{test_student_uuid}}`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `correctAnswers`: `null`
  - `evaluatedAt`: `null`
  - `examId`: `string`
  - `id`: `string`
  - `passed`: `null`
  - `scorePercentage`: `null`
  - `startedAt`: `string`
  - `status`: `string`
  - `submittedAt`: `null`
  - `totalQuestions`: `null`
  - `userId`: `string`

### 25. Submit Exam Attempt
- Endpoint: `POST /api/student/exams/attempts/{{attempt_id}}/submit`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `correctAnswers`: `number`
  - `evaluatedAt`: `string`
  - `examId`: `string`
  - `id`: `string`
  - `passed`: `boolean`
  - `scorePercentage`: `number`
  - `startedAt`: `string`
  - `status`: `string`
  - `submittedAt`: `string`
  - `totalQuestions`: `number`
  - `userId`: `string`

### 26. Enroll in Published Course
- Endpoint: `POST /api/learner/enrollments/course/{{course_id}}`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `user`: `object`
  - `course`: `object`
  - `completedAt`: `null`
  - `enrolledAt`: `string`
  - `id`: `number`
  - `lastAccessedAt`: `null`
  - `status`: `string`

### 27. List My Enrollments
- Endpoint: `GET /api/learner/enrollments`
- Verified status: `200`
- Response body type: `array`
- Sample length in run: `1`
- Array item shape (top-level):
  - `user`: `object`
  - `course`: `object`
  - `completedAt`: `null`
  - `enrolledAt`: `string`
  - `id`: `number`
  - `lastAccessedAt`: `null`
  - `status`: `string`

### 28. Start Enrollment Progress
- Endpoint: `POST /api/learner/progress/enrollment/{{enrollment_id}}/start`
- Verified status: `200`
- Response body: empty

### 29. Complete Lesson
- Endpoint: `POST /api/learner/progress/enrollment/{{enrollment_id}}/lesson/{{lesson_text_id}}/complete`
- Verified status: `200`
- Response body: empty

### 30. Drop Enrollment
- Endpoint: `DELETE /api/learner/enrollments/{{enrollment_id}}`
- Verified status: `204`
- Response body: empty

### 31. Create Homepage Section
- Endpoint: `POST /api/admin/homepage/sections`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `enabled`: `boolean`
  - `id`: `string`
  - `orderIndex`: `number`
  - `position`: `string`
  - `title`: `string`

### 32. Create Homepage Block
- Endpoint: `POST /api/admin/homepage/blocks`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `blockType`: `string`
  - `enabled`: `boolean`
  - `id`: `string`
  - `orderIndex`: `number`
  - `sectionId`: `string`

### 33. Get Homepage (Public)
- Endpoint: `GET /api/public/homepage`
- Verified status: `200`
- Response body type: `array`
- Sample length in run: `8`
- Array item shape (top-level):
  - `section`: `object`
  - `blocks`: `array`

### 34. Get Active Courses
- Endpoint: `GET /api/admin/courses/active`
- Verified status: `200`
- Response body type: `array`
- Sample length in run: `5`
- Array item shape (top-level):
  - `archived`: `boolean`
  - `createdAt`: `string`
  - `createdByRole`: `string`
  - `deleted`: `boolean`
  - `descriptionEn`: `string`
  - `difficulty`: `string`
  - `estimatedDurationMinutes`: `number`
  - `hierarchyNode`: `object`
  - `id`: `number`
  - `languageCode`: `string`
  - `sortOrder`: `number`
  - `status`: `string`
  - `titleEn`: `string`
  - `updatedAt`: `string`
  - `version`: `number`

### 35. Archive Exam
- Endpoint: `POST /api/admin/exams/{{exam_id}}/archive`
- Verified status: `200`
- Response body type: `object`
- Object shape (top-level):
  - `courseId`: `number`
  - `createdAt`: `string`
  - `description`: `string`
  - `id`: `string`
  - `instructions`: `string`
  - `maxAttempts`: `number`
  - `passPercentage`: `number`
  - `rulesSummary`: `string`
  - `shuffleOptions`: `boolean`
  - `shuffleQuestions`: `boolean`
  - `status`: `string`
  - `timeLimitMinutes`: `number`
  - `title`: `string`
  - `updatedAt`: `string`

### 36. Archive Course
- Endpoint: `POST /api/admin/courses/{{course_id}}/archive`
- Verified status: `200`
- Response body: empty

### 37. Delete Lesson (Soft)
- Endpoint: `DELETE /api/admin/lessons/{{lesson_doc_id}}`
- Verified status: `204`
- Response body: empty

### 38. Delete Course (Soft)
- Endpoint: `DELETE /api/admin/courses/{{course_id}}`
- Verified status: `200`
- Response body: empty

### 39. Admin Endpoint Without Token
- Endpoint: `GET /api/admin/courses/active`
- Verified status: `401`
- Response body: empty

### 40. Admin Endpoint With Student Token
- Endpoint: `GET /api/admin/courses/active`
- Verified status: `401`
- Response body: empty

## Error Shape Contract

Structured error responses follow `ApiError` with these fields:
- `timestamp: string` (ISO datetime)
- `status: number`
- `error: string`
- `code: string`
- `message: string`
- `path: string`

Verified in suite for unauthorized admin access checks (`401`).
